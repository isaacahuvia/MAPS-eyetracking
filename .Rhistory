#############################
##   Eyetracking Data #3   ##
##  Make Eyetracking Data  ##
#############################
rm(list = ls())
library(yaml)
library(eyetrackingR)
lookup <- yaml::read_yaml("R:\\MSS\\Research\\Projects\\MAPS-FUS\\Tween Wave\\Survey Visit (ECHO)\\Code\\Eyetracking\\Eyetracking Lookup.yaml")
####  Read Data  ####
load(file = lookup$clean_data$with_AOIs)
####  Transform into Eyetracking Data  ####
#See http://www.eyetracking-r.com/vignettes/preparing_your_data
df <- make_eyetrackingr_data(df,
participant_column = "participantID",
trial_column = "qID",
time_column = "timestamp",
trackloss_column = "trackLoss",
aoi_columns = c("qText", "c1", "c2", "c3", "c4", "c5", "submit"),
treat_non_aoi_looks_as_missing = F)
####  Output Data  ####
save(df, file = lookup$clean_data$analysis_ready)
###########################
##  Eyetracking Data #2  ##
##        Add qID        ##
###########################
rm(list = ls())
library(yaml)
library(openxlsx)
library(eyetrackingR)
lookup <- yaml::read_yaml("R:\\MSS\\Research\\Projects\\MAPS-FUS\\Tween Wave\\Survey Visit (ECHO)\\Code\\Eyetracking\\Eyetracking Lookup.yaml")
####  Read Data  ####
load(file = lookup$clean_data$merged)
lookup <- openxlsx::read.xlsx(lookup$qID_lookup)
####  Create qID Column  ####
df$qID <- NA
for(i in 1:nrow(lookup)) {
df$qID[df$qText == lookup$qText[i]] <- lookup$qID[i]
}
# Fill in NAs; these were questions that came first in the test, and therefore Tobii does not collect question text data. Logically, these are
# the questions that came before the following question in each instrument
df$qID.lead <- lead(df$qID, 1)
look <- df[df$qID != lead(df$qID,1),]
head(look)
View(look)
sum(is.na(df$participantID))
rm(list = ls())
library(yaml)
library(openxlsx)
library(eyetrackingR)
lookup <- yaml::read_yaml("R:\\MSS\\Research\\Projects\\MAPS-FUS\\Tween Wave\\Survey Visit (ECHO)\\Code\\Eyetracking\\Eyetracking Lookup.yaml")
####  Read Data  ####
load(file = lookup$clean_data$merged)
lookup <- openxlsx::read.xlsx(lookup$qID_lookup)
####  Create qID Column  ####
df$qID <- NA
for(i in 1:nrow(lookup)) {
df$qID[df$qText == lookup$qText[i]] <- lookup$qID[i]
}
# Fill in NAs; these were questions that came first in the test, and therefore Tobii does not collect question text data. Logically, these are
# the questions that came before the following question in each instrument
df$qID.lead <- lead(df$qID, 1)
View(df[df$qID != df$qID.lead,])
sum(is.na(df$participantID))
View(df[df$qID != df$qID.lead & !is.na(df$qID),])
